---
title: "Visualization"
subtitle: "Part 1"
output: github_document
---

```{r setup}
library(tidyverse)
library(ggridges)
```

## Load the weather data

We’ll be working with NOAA weather data, which is downloaded using rnoaa::meteo_pull_monitors function in the code chunk below; similar code underlies the weather dataset used elsewhere in the course. Because this process can take some time, I’ll cache the code chunk:

```{r}
weather_df = 
  rnoaa::meteo_pull_monitors(
    c("USW00094728", "USC00519397", "USS0023B17S"),
    var = c("PRCP", "TMIN", "TMAX"), 
    date_min = "2017-01-01",
    date_max = "2017-12-31") %>%
  mutate(
    name = recode(
      id, 
      USW00094728 = "CentralPark_NY", 
      USC00519397 = "Waikiki_HA",
      USS0023B17S = "Waterhole_WA"),
    tmin = tmin / 10,
    tmax = tmax / 10) %>%
  select(name, id, everything())
```

## Scatterplots!

Create my first scatterplot ever
```{r}
ggplot(weather_df, aes(x = tmin, y = tmax)) + 
  geom_point()


```

Same plot, new approach:
```{r}
weather_df %>%
  ggplot(aes(x = tmin, y = tmax)) +
  geom_point()
```

Save and edit a plot object.
```{r}
weather_plot =
  weather_df %>%
  ggplot(aes(x = tmin, y = tmax))

weather_plot + geom_point() #each item in ggplot treated as separate (+ signs between)
```

## Advanced S\scatterplot...

Start with the same scatterplot as above and make it fancy!

```{r}
weather_df %>%
  ggplot(aes(x = tmin, y = tmax, color = name)) +
  geom_point() +
  geom_smooth(se = FALSE) #add smooth curves to data
```

What about the `aes` placement...?

```{r}
weather_df %>%
  ggplot(aes(x = tmin, y = tmax)) +
  geom_point(aes(color = name)) +
  geom_smooth()
```
When we define color=name inside the geom_point call, geom_smooth plots one line for all the data (rather than one line per color/city). This is because color = name no longer applies to the entire plot, but to the scatter points only. Defining aesthetics in ggplot() will define it everywhere else, unless you take steps (as above) to change that.

Let's facet some things!
```{r}
weather_df %>%
  ggplot(aes(x = tmin, y = tmax, color = name)) +
  geom_point() +
  geom_smooth(se = FALSE) +
  facet_grid(. ~ name) #facet_grid(row definition ~ column definition) where . = none
#separates graphs by defined variable

weather_df %>%
  ggplot(aes(x = tmin, y = tmax, color = name)) +
  geom_point() +
  geom_smooth(se = FALSE) +
  facet_grid(name ~ .) #same code with rows instead of columns

weather_df %>%
  ggplot(aes(x = tmin, y = tmax, color = name)) +
  geom_point(alpha = .2, size = 1) + #customize transparency and size of points
  geom_smooth(se = FALSE, size = 2) + #customize size of line
  facet_grid(. ~ name) 

weather_df %>%
  ggplot(aes(x = tmin, y = tmax, alpha = tmin, color = name)) + #set alpha to x in first line, transparency now depends on x. Can link aesthetics to variables here or define globally below.
  geom_point() + 
  geom_smooth(se = FALSE, size = 2) +
 
```

Let's combine some elements and try a new plot:

```{r}
weather_df %>%
  ggplot(aes(x = date, y = tmax, color = name)) +
  geom_point(aes(size = prcp), alpha = 0.5) + 
  geom_smooth(se = FALSE) + 
  facet_grid(. ~ name) 
```

## Some small notes

How many geoms() have to exist?

You can have whatever geoms you want. For example, the chunk below maps the curves but not the data points.

```{r}
weather_df %>%
  ggplot(aes(x = tmin, y = tmax, color = name)) +
  geom_smooth(se = FALSE)
```

You can use a neat geom!

```{r}
weather_df %>%
  ggplot(aes(x = tmin, y = tmax)) +
  geom_density2d() + #must install hexbin package to run
  geom_point(alpha = 0.3)

#also: geom_hex() for 2d scatterplot with hexograms, geom_bin2d()), geom_density2d(), etc
```

## Univariate plots

### Histograms
Histograms are really great. Simple histogram:
```{r}
weather_df %>%
  ggplot(aes(x = tmin)) +
  geom_histogram()
```

Histogram with some fancy features:

```{r}
weather_df %>%
  ggplot(aes(x = tmin, fill = name)) + #add color by city name
  geom_histogram(position = "dodge") + #separate bars instead of default overlaying
  facet_grid(. ~ name) #separates histograms to different grids
```

### Density plots
Let's try a new geometry! Density plots are like smooth histograms:

```{r}
weather_df %>%
  ggplot(aes(x = tmin, fill = name)) +
  geom_density(alpha = 0.3) #transparency
```

### Box plots

```{r}
weather_df %>%
  ggplot(aes(x = name, y = tmin)) +
  geom_boxplot()
```

```{r}

```

